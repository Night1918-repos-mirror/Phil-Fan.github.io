# 80C51

## 简介

- 什么是单片机 

一台能够工作的计算机要有这样几个部份构成：**CPU（进行运算、控制）、**
**RAM（数据存储）、ROM（程序存储）、输入/输出设备（例如：串行口、并行输出口等）**。
在个人计算机上这些部份被分成若干块芯片，安装一个称之为主板的印刷线路板上。

而在单片机中，这些部份全部被做到**一块集成电路芯片**中了，所以就称为单片（单芯片）机，一个微型的计算机，而加上晶振，存储器，地址锁存器，逻辑门，七段译码器（显示器），按钮（类似键盘），扩展芯片，接口等那是单片机系统。



- MCS51 单片机和8051、8031、89C51 等的关系

  - MCS51 是指由美国INTEL 公司生产的一系列单片机的总称，这一系列单片机包括了好些品种，如8031，8051，8751，8032，8052，8752 等
  - 其中8051 是最早最典型的产品，该系列其它单片机都是在8051 的基础上进行功能的增、减、改变而来的，所以人们习惯于用8051 来称呼MCS51 系列单片机

  - 而8031 是前些年在我国最流行的单片机，所以很多场合会看到8031 的名称。INTEL 公司将MCS51 的核心技术授权给了很多其它公司

![image-20240327115106406](https://philfan-pic.oss-cn-beijing.aliyuncs.com/img/image-20240327115106406.png)



## 结构

### 引脚

单片机的40 个引脚大致可分为4 类：

**电源、时钟、控制和I/O 引脚。**

![51单片机引脚图](https://philfan-pic.oss-cn-beijing.aliyuncs.com/img/image-20240228113806275.png)

#### 电源

⑴ VCC - 芯片电源，接+5V；
⑵ VSS - 接地端；



#### 时钟

`XTAL1`、`XTAL2` - 晶体振荡电路反相输入端和输出端。

#### 控制线4根

- ⑴ `ALE/PROG`:地址锁存允许/片内EPROM 编程脉冲

  - ① `ALE `功能：用来锁存`P0`口送出的低8位地址

  - ② `PROG` 功能：片内有`EPROM` 的芯片，在EPROM 编程期间，此引脚输入编程脉冲。

- ⑵ `PSEN`:外`ROM` 读选通信号。

- ⑶ `RST/VPD`:复位/备用电源。

  - ① `RST（Reset）`功能：复位信号输入端。

  - ② `VPD `功能：在`Vcc` 掉电情况下，接备用电源。

- ⑷ `EA/Vpp`:内外`ROM` 选择/片内`EPROM` 编程电源。

  - ① `EA` 功能：内外`ROM` 选择端。

  - ②` Vpp `功能：片内有`EPROM `的芯片，在`EPROM `编程期间，施加编程电源`Vpp`。



#### I/O 线

80C51 共有4个8位并行I/O 端口：

**P0,P1,P2,P3 口**，共32 个引脚。

P3 口还具有第二功能，用于特殊信号输入输出和控制信号（属控制总线）

![复位连线图像](https://philfan-pic.oss-cn-beijing.aliyuncs.com/img/image-20240228114417029.png)



**存储器构造**

## 程序存储器 ROM

（READ ONLY MEMORY）

在89C51 中的ROM 是一种电可擦除的ROM，称为FLASH ROM

所谓随机存取存储器，即随时能改写，也能读出里面的数据，它类似于我们的黑板，我能随时写东西上去，也能用黑板擦擦掉重写。



## 数据存储器 RAM

（READ RANDOM MEMORY）

所谓随机存取存储器，即随时能改写，也能读出里面的数据，它类似于我们的黑板，我能随时写东西上去，也能用黑板擦擦掉重写。

**存储器译码**

65536 种状态我们只需要16 根线就能代表了



从上面的介绍中我们已经看到，用来传递数据的八根线并不是专用的，而是很多器件大家共用的，所以我们称之为数据总线，总线英文名为BUS，总即公交车道，谁者能走。而十六根地址线也是连在一起的，称之为地址总线

### 寄存器



## 指令

![image-20240327115152798](https://philfan-pic.oss-cn-beijing.aliyuncs.com/img/image-20240327115152798.png)





### 数据传递

### 算数运算

### 逻辑运算

### 条件转移

### 位运算



## 并行IO($P_0 - P_3$​ )

全双工：通信双方可以在同一时刻互相传输数据

半双工：通信双方可以互相传输数据，但必须分时复用一根数据线

单工：通信只能有一方发送到另一方，不能反向传输



异步：通信双方各自约定通信速率

同步：通信双方靠一根时钟线来约定通信速率



总线：连接各个设备的数据传输线路（类似于一条马路，把路边各住户连接起来，使住户可以相互交流）





HEX模式/十六进制模式/二进制模式：以原始数据的形式显示

文本模式/字符模式：以原始数据编码后的形式显示

## 串行口

## 定时 / 计数

定时器在单片机内部就像一个小闹钟一样，根据时钟的输出信号，每隔“一秒”，计数单元的数值就增加一，当计数单元数值增加到“设定的闹钟提醒时间”时，计数单元就会向中断系统发出中断申请，产生“响铃提醒”，使程序跳转到中断服务函数中执行

## 中断

中断系统是为使CPU具有对外界紧急事件的实时处理能力而设置的，当中央处理机CPU正在处理某件事的时候外界发生了紧急事件请求，要求CPU暂停当前的工作，转而去处理这个紧急事件，处理完以后，再回到原来被中断的地方，继续原来的工作，这样的过程称为中断。

实现这种功能的部件称为中断系统，请示CPU中断的请求源称为中断源。微型机的中断系统一般允许多个中断源，当几个中断源同时向CPU请求中断，要求为它服务的时候，这就存在CPU优先响应哪一个中断源请求的问题。通常根据中断源的轻重缓急排队，优先处理最紧急事件的中断请求源，即规定每一个中断源有一个优先级别。CPU总是先响应优先级别最高的中断请求。

![image-20240327115545079](https://philfan-pic.oss-cn-beijing.aliyuncs.com/img/image-20240327115545079.png)





## 实验

### 01 点亮一只发光二极管LED

按照这个图的接法，当1 脚是高电平时，LED 不亮，只有1 脚是低电平时，LED 才发亮。

因此要1 脚我们要能够控制，也就是说，我们要能够让1 管脚按要求变为高或低电平。即然
我们要控制1 脚，就得给它起个名字，总不

能就叫它一脚吧？叫它什么名字呢？设计51 芯片的INTEL 公司已经起好了，就叫它P1.0，这是规定，不能由我们来更改。

![image-20240327113053124](https://philfan-pic.oss-cn-beijing.aliyuncs.com/img/image-20240327113053124.png)

## 编程

•.c文件：函数、变量的定义

•.h文件：可被外部调用的函数、变量的声明

- 任何自定义的变量、函数在调用前必须有定义或声明（同一个.c）

- 使用到的自定义函数的.c文件必须添加到工程参与编译

- 使用到的.h文件必须要放在编译器可寻找到的地方（工程文件夹根目录、安装目录、自定义）
